#▄▄▄▄▄─────────────────────────▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄¦⌠#
#░░░░░      SublimeSlides      ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░s2#
#▀▀▀▀▀─────────────────────────▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀¦⌡#

#                          :yddNMh:
#                        -yMMMMMMMMm.                                                                                       ■■■
#                       :NMMMMMMMMMMh`                                ......................................................║║║.........................................................
#                      `NMMMMMMMMMMMM.                o-            /||≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡||\
#                      `dMMMMMMMMMMMM.               oM:           .||'                                                                                                                '||:
#                       +MMMMMMMMMMMN`              :Mm--`         :||                                                                                                                  ||:
#                       `oNMMMMMMMMm:            :o.dMMNNhs        :||                                                                                                                  ||:
#                         dMMMMMMMMs             yMhNMMMMMMd.      :||                                                                                                                  ||:
#                       .:hNMMMMMNy. ..`-:+-     `dMMMMMMMmh.      :||                                                                                                                  ||:
#              .:::::+shN/`.::s+:.ohhosdNNMmoo/.  /MMMMMMM/`       :||                                                                                                                  ||:
#             sNMMMMMMMMM/   /NN- `dMMMMMMMMMMMm-./NMMMMMd`        :||   $$$$$$\            $$\       $$\ $$\                          $$$$$$\  $$\ $$\       $$\                       ||:
#            :MMMMMMMMMMN.   .mm.  :NMMMMMMNhNMMNN/.:+os+`         :||  $$  __$$\           $$ |      $$ |\__|                        $$  __$$\ $$ |\__|      $$ |                      ||:
#           `dMMMMMMMMMMm    `MMs   oMMMMMMMNhMMMMh`               :||  $$ /  \__|$$\   $$\ $$$$$$$\  $$ |$$\ $$$$$$\$$$$\   $$$$$$\  $$ /  \__|$$ |$$\  $$$$$$$ | $$$$$$\   $$$$$$$\   ||:
#           hMMMMMMMMMMMm    +MMN`  `yMMhMMMMMMMMMMdy++++s:        :||  \$$$$$$\  $$ |  $$ |$$  __$$\ $$ |$$ |$$  _$$  _$$\ $$  __$$\ \$$$$$$\  $$ |$$ |$$  __$$ |$$  __$$\ $$  _____|  ||:
#          :MMMMMMMMMMMMm    mMMM+    hMMMMMMMMMMMMMMMMmd/`        :||   \____$$\ $$ |  $$ |$$ |  $$ |$$ |$$ |$$ / $$ / $$ |$$$$$$$$ | \____$$\ $$ |$$ |$$ /  $$ |$$$$$$$$ |\$$$$$$\    ||:
#         `hMMMMMMMMMMMMm    NMMMd    .MMMMMMhdmmMMMMNh.`          :||  $$\   $$ |$$ |  $$ |$$ |  $$ |$$ |$$ |$$ | $$ | $$ |$$   ____|$$\   $$ |$$ |$$ |$$ |  $$ |$$   ____| \____$$\   ||:
#         yMMMMMMMMMMMMMm    NMMMd     MMMMMM.``.-----`            :||  \$$$$$$  |\$$$$$$  |$$$$$$$  |$$ |$$ |$$ | $$ | $$ |\$$$$$$$\ \$$$$$$  |$$ |$$ |\$$$$$$$ |\$$$$$$$\ $$$$$$$  |  ||:
#        -NMMMMMMMMMMMMMm    NMMMd     MMMMMh                      :||   \______/  \______/ \_______/ \__|\__|\__| \__| \__| \_______| \______/ \__|\__| \_______| \_______|\_______/   ||:
#        /MMMMMMMMMMMMMMN.   NMMMd    -MMMMMy                      :||                                                                                                                  ||:
#       -mMMMMMMMMMMMMMMM/   NMMMd    sMMMMM/                      :||                                                                                                                  ||:
#      `mMMMMMMMMMMMMMMMM/   NMMMd   .NMMMMM-                      :||                                                                                                                  ||:
#       oMMMMMMMMMmsohMMMNh: NMMMd   dMMMMMN.                      :||                                                                                                                  ||:
#       `hMMMMMMMd`.hMMMMMMy`mMMNs  :MMMMMMh                       :||                                                                                                                  ||:
#        `+mNMMMM: /MMMMMMN- .hm:  .hMMMMMMm`                      .||.                                                                                                                .||:
#          .:/mMMo-oMMMMMNyhhhy/`+ydMMMMMMMMs                       \||≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡||/
#     .----------------------------------------------.               \..............................................║║║.....║║║.....║║║................................................./
#     |mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm|                                                             ║║║      ║║║      ║║║
#      │nnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnn│                                                             ║║║       ║║║       ║║║
#      │mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm│                                                            ║║║        ║║║        ║║║
#      │nnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnn│                                                           ║║║         ║║║         ║║║
#       \mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm/                                                           ║║║          ║║║          ║║║
#        \nnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnn/                                                           ║║║           ║║║           ║║║
#         \++++++++++++++++++++++++++++++++++++++/                                                           ║║║            ║║║            ║║║
#          │mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm│                                                           ║║║             ║║║             ║║║
#          │mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm│                                                          ║║║              ║║║              ║║║
#          │mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm│                                                         ║║║               ║║║               ║║║
#          │mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm│                                                        ║║║                ║║║                ║║║
#          │mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm│                                                       ║║║                 ║║║                 ║║║
#          │mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm│                                                      ║║║                  ║║║                  ║║║
#          │────────────────────────────────────│                                                     ■■■                   ■■■                   ■■■
#           ‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾

#▄▄▄▄▄──────────────────▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄¦⌠#
#░░░░░      Import      ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░s2#
#▀▀▀▀▀──────────────────▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀¦⌡#

import sublime, sublime_plugin, re, os, subprocess

#▐▌▒▓▒▐▌═══════════════════════════════════════════════════════════════▐▌▒▓▒▐▌▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄¦⌠#
#▐▌▓▒▓▐▌                                                               ▐▌▓▒▓▐▌▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓‡#
#▐▌▒▓▒▐▌      SublimeSlidesCommand ( sublime_plugin.TextCommand )      ▐▌▒▓▒▐▌████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████c3#
#▐▌▓▒▓▐▌                                                               ▐▌▓▒▓▐▌▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓‡#
#▐▌▒▓▒▐▌═══════════════════════════════════════════════════════════════▐▌▒▓▒▐▌▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀¦⌡#

class SublimeSlidesCommand ( sublime_plugin.TextCommand ):

	def run ( self, edit, mode ):

		view = self.view

		if   mode == "NavigateSlides_Down" :     Commands.navigate_Slides     ( view, "Down" )
		elif mode == "NavigateSlides_Up" :       Commands.navigate_Slides     ( view, "Up" )
		elif mode == "NavigateMediaLinks_Down" : Commands.navigate_MediaLinks ( view, "Down" )
		elif mode == "NavigateMediaLinks_Up" :   Commands.navigate_MediaLinks ( view, "Up" )
		elif mode == "Zoom_In" :                 Commands.zoom_In             ( view, "Manual" )
		elif mode == "Zoom_Out" :                Commands.zoom_Out            ( view )
		elif mode == "Insert_Slide" :            Commands.insert_Slide        ( edit, view )
		elif mode == "Insert_MediaFile" :        Commands.insert_MediaFile    ( edit, view )
		elif mode == "Insert_MediaLink" :        Commands.insert_MediaLink    ( edit, view, True, False )
		elif mode == "Open_MediaLink" :          Commands.open_MediaLink      ( view )
		elif mode == "Toggle_MediaLink" :        Commands.toggle_MediaLink    ()
		elif mode == "Align" :                   Commands.align_Titles        ( edit, view )

#▐▌▒▓▒▐▌════════════════════▐▌▒▓▒▐▌▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄¦⌠#
#▐▌▓▒▓▐▌                    ▐▌▓▒▓▐▌▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓‡#
#▐▌▒▓▒▐▌      Commands      ▐▌▒▓▒▐▌███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████c3#
#▐▌▓▒▓▐▌                    ▐▌▓▒▓▐▌▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓‡#
#▐▌▒▓▒▐▌════════════════════▐▌▒▓▒▐▌▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀¦⌡#

class Commands ():

	#▓▓▓▓▓──────────────────────────────▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓¦•⌠#
	#░░░░░                              ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░‡#
	#░░░░░      •   { Navigation }      ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░g3#
	#░░░░░                              ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░‡#
	#▓▓▓▓▓──────────────────────────────▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓¦•⌡#

		#▐▌»»▒▐▌───────────────────────▐▌▒««▐▌__________________________________________________________________________________________________________________________________________________________¦••⌠#
		#▐▌»»▒▐▌    • •   zoom_In      ▐▌▒««▐▌░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬m2#
		#▐▌»»▒▐▌───────────────────────▐▌▒««▐▌‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾¦••⌡#

	def zoom_In ( view, zoomMode ):

		if zoomMode == "Manual":

			userSettings = sublime.load_settings ( "SublimeSlides.sublime-settings" )
			titleEndcap  = userSettings.get ( "title_endcap", "" )
			titleFill    = userSettings.get ( "title_fill", "" )

			selectedRegions = view.sel ()

			if len ( selectedRegions ) == 0:
				return

			cursorSelection         = selectedRegions [0]
			cursorSelection_A       = cursorSelection.a
			cursorLine_A            = view.line ( cursorSelection_A )
			cursorLine_Text         = view.substr ( cursorLine_A )
			cursorRow, cursorColumn = view.rowcol ( cursorSelection_A )

			if cursorLine_Text.find ( titleEndcap ) == -1:
				return

		documentStart  = 0
		documentEnd    = view.size ()
		documentRegion = sublime.Region ( documentStart, documentEnd )

		contentRegion        = Commands.find_Slides ( view, "Single" )
		contentRegion_A      = contentRegion.a
		contentRegion_B      = contentRegion.b

		if contentRegion_A == -1 \
		or contentRegion_B == -1:
			return

		view.unfold ( documentRegion )

		if contentRegion_A != documentStart \
		and contentRegion_A > documentStart:
			foldRegion = sublime.Region ( documentStart, contentRegion_A - 1 )
			view.fold ( foldRegion )

		if contentRegion_B != documentEnd \
		and contentRegion_B < documentEnd:
			foldRegion = sublime.Region ( contentRegion_B, documentEnd )
			view.fold ( foldRegion )

		view.selection.clear ()
		view.selection.add ( contentRegion_A )

		view.set_viewport_position ( [ 0, 0 ], animate = False )

		#▐▌»»▒▐▌────────────────────────▐▌▒««▐▌_________________________________________________________________________________________________________________________________________________________¦••⌠#
		#▐▌»»▒▐▌    • •   zoom_Out      ▐▌▒««▐▌░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░m2#
		#▐▌»»▒▐▌────────────────────────▐▌▒««▐▌‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾¦••⌡#

	def zoom_Out ( view ):

		view.run_command ( "unfold_all" )

		view.selection.clear ()
		view.selection.add ( 0 )

		view.set_viewport_position ( [ 0, 0 ], animate = False )

		#▐▌»»▒▐▌───────────────────────────────▐▌▒««▐▌__________________________________________________________________________________________________________________________________________________¦••⌠#
		#▐▌»»▒▐▌    • •   navigate_Slides      ▐▌▒««▐▌░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬m2#
		#▐▌»»▒▐▌───────────────────────────────▐▌▒««▐▌‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾¦••⌡#

	def navigate_Slides ( view, direction ):

		slideRegions      = Commands.find_Slides ( view, "All" )
		slideRegion_Count = len ( slideRegions )

		visibleRegion = Commands.get_VisibleRegion ( view, True )

		if slideRegion_Count <= 0 \
		or visibleRegion == False:
			return

		contentIndex        = 0
		visibleRegion_Index = 0
		newRegion           = sublime.Region ( 0, 0 )

		for region in slideRegions:
			if region == visibleRegion:
				visibleRegion_Index = contentIndex
			contentIndex = contentIndex + 1

		if visibleRegion_Index + 1 < slideRegion_Count \
		and direction == "Down":
			newRegion = slideRegions [visibleRegion_Index + 1]
			view.selection.clear ()
			view.selection.add ( newRegion.a )
			Commands.zoom_In ( view, "Automatic" )

		elif visibleRegion_Index - 1 >= 0 \
		and direction == "Up":
			newRegion = slideRegions [visibleRegion_Index - 1]
			view.selection.clear ()
			view.selection.add ( newRegion.a )
			Commands.zoom_In ( view, "Automatic" )

		view.set_viewport_position ( [ 0, 0 ], animate = False )

		#▐▌»»▒▐▌───────────────────────────────────▐▌▒««▐▌______________________________________________________________________________________________________________________________________________¦••⌠#
		#▐▌»»▒▐▌    • •   navigate_MediaLinks      ▐▌▒««▐▌░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬m2#
		#▐▌»»▒▐▌───────────────────────────────────▐▌▒««▐▌‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾¦••⌡#

	def navigate_MediaLinks ( view, direction ):

		mediaLink_Found = False

		userSettings             = sublime.load_settings ( "SublimeSlides.sublime-settings" )
		mediaLink_Character      = userSettings.get ( "medialink_character", "" )
		mediaLink_OnNav_Enabled  = userSettings.get ( "medialink_on_navigate", "" )
		commentStart, commentEnd = Commands.get_CommentCharacters ()

		mediaLink_Prefix      = commentStart + mediaLink_Character + V.spaceCharacter
		mediaLink_LeftOffset = len ( mediaLink_Prefix )

		mediaLink_Regions     = Commands.find_MediaLinks ( view )
		mediaLink_RegionCount = len ( mediaLink_Regions )

		if direction == "Up":
			mediaLink_Regions = reversed ( mediaLink_Regions )

		selectedRegions = view.sel ()
		visibleRegion   = Commands.get_VisibleRegion ( view, False )

		if mediaLink_RegionCount <= 0 \
		or visibleRegion == False \
		or len ( selectedRegions ) == 0:
			return

		visibleRegion_A = visibleRegion.a
		visibleRegion_B = visibleRegion.b

		cursorSelection        = selectedRegions [0]
		cursorSelection_A      = cursorSelection.a
		cursorSelection_Line_A = view.line ( cursorSelection_A ).a
		cursorSelection_Line_B = view.line ( cursorSelection_A ).b

		for region in mediaLink_Regions:

			if direction == "Down" \
			and region.a >= visibleRegion_A \
			and region.a > cursorSelection_Line_B \
			and region.b <= visibleRegion_B:
				mediaLink_Found = True
				break

			elif direction == "Up" \
			and region.a >= visibleRegion_A \
			and region.a < cursorSelection_Line_A - mediaLink_LeftOffset \
			and region.b <= visibleRegion_B:
				mediaLink_Found = True
				break

		if mediaLink_Found == True \
		and mediaLink_OnNav_Enabled == "True":
			view.selection.clear ()
			selectionRegion = sublime.Region ( region.a + mediaLink_LeftOffset + 1, region.a + mediaLink_LeftOffset + 1 )
			view.selection.add ( selectionRegion )
			Commands.open_MediaLink ( view )

		view.set_viewport_position ( [ 0, 0 ], animate = False )

	#▓▓▓▓▓────────────────────────────▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓¦•⌠#
	#░░░░░                            ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░‡#
	#░░░░░      •   { Snippets }      ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░g3#
	#░░░░░                            ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░‡#
	#▓▓▓▓▓────────────────────────────▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓¦•⌡#

		#▐▌»»▒▐▌────────────────────────────▐▌▒««▐▌_____________________________________________________________________________________________________________________________________________________¦••⌠#
		#▐▌»»▒▐▌    • •   insert_Slide      ▐▌▒««▐▌░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░m2#
		#▐▌»»▒▐▌────────────────────────────▐▌▒««▐▌‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾¦••⌡#

	def insert_Slide ( edit, view ):

		userSettings             = sublime.load_settings ( "SublimeSlides.sublime-settings" )
		mediaLink_Character      = userSettings.get ( "medialink_character", "" )
		mediaLink_TabAmount      = userSettings.get ( "medialink_tab_amount", "" )
		mediaLink_WrapperFill    = userSettings.get ( "medialink_wrapper_fill", "" )
		titleEndcap              = userSettings.get ( "title_endcap", "" )
		titleFill                = userSettings.get ( "title_fill", "" )
		commentStart, commentEnd = Commands.get_CommentCharacters ()

		slideTitle_Regions = []

		selectedRegions = view.sel ()

		for region in selectedRegions:

			region.a                = region.a
			regionLine_A            = view.line ( region.a )
			regionText              = view.substr ( regionLine_A ).strip ()
			cursorRow, cursorColumn = view.rowcol ( region.a )

			cursor_AtLineStart = False

			if cursorColumn == 0:
				cursor_AtLineStart = True

			if cursor_AtLineStart == True \
			and regionText == "":
				slideTitle = V.slide_DefaultTitle
			else:
				slideTitle = regionText

			invalidLine    = False

			if regionText.find ( mediaLink_Character )   >= 0 : invalidLine = True
			if regionText.find ( mediaLink_WrapperFill ) >= 0 : invalidLine = True
			if regionText.find ( titleEndcap )           >= 0 : invalidLine = True
			if regionText.find ( titleFill )             >= 0 : invalidLine = True
			if regionText.find ( commentStart )          >= 0 : invalidLine = True
			if regionText.find ( commentEnd )            >= 0 : invalidLine = True

			if invalidLine == True:
				continue

			titleLine_Text = Commands.add_TitleMarkers ( slideTitle, "Text")
			titleOffset    = Commands.add_TitleMarkers ( slideTitle, "Offset" )

			view.replace ( edit, regionLine_A, titleLine_Text )

			regionLine_A  = view.line ( region.a )
			titlePosition = regionLine_A.a + titleOffset
			titleRegion   = sublime.Region ( titlePosition, titlePosition + len ( slideTitle ) )
			slideTitle_Regions.append ( titleRegion )

		view.selection.clear ()
		view.selection.add_all ( slideTitle_Regions )
		view.run_command ( "reverse_selection_direction" )

		#▐▌»»▒▐▌────────────────────────────────▐▌▒««▐▌_________________________________________________________________________________________________________________________________________________¦••⌠#
		#▐▌»»▒▐▌    • •   insert_MediaLink      ▐▌▒««▐▌░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░m2#
		#▐▌»»▒▐▌────────────────────────────────▐▌▒««▐▌‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾¦••⌡#

	def insert_MediaLink ( edit, view, wrapperEnabled, block_ExistingLines ):

		mediaLink_Regions = []

		userSettings             = sublime.load_settings ( "SublimeSlides.sublime-settings" )
		mediaLink_Character      = userSettings.get ( "medialink_character", "" )
		mediaLink_TabAmount      = userSettings.get ( "medialink_tab_amount", "" )
		mediaLink_WrapperFill    = userSettings.get ( "medialink_wrapper_fill", "" )
		titleEndcap              = userSettings.get ( "title_endcap", "" )
		titleFill                = userSettings.get ( "title_fill", "" )
		commentStart, commentEnd = Commands.get_CommentCharacters ()

		mediaLink_Title_Default = V.mediaLink_DefaultTitle
		mediaLink_StartText     = commentStart + mediaLink_Character + V.spaceCharacter
		mediaLink_Prefix        = ( V.tabCharacter * mediaLink_TabAmount ) + mediaLink_StartText
		mediaLink_Suffix        = V.spaceCharacter + mediaLink_Character

		if commentEnd != "":
			mediaLink_Suffix = mediaLink_Suffix + commentEnd

		selectedRegions = view.sel ()

		for region in selectedRegions:

			region.a                = region.a
			region.b                = region.b
			regionLine_A            = view.line ( region.a )
			regionLine_B            = view.line ( region.b )
			regionText              = view.substr ( regionLine_A ).strip ()
			cursorRow, cursorColumn = view.rowcol ( region.a )

			cursor_AtLineStart = False

			if cursorColumn == 0:
				cursor_AtLineStart = True

			invalidLine    = False
			mediaLink_Line = False

			if regionText.find ( mediaLink_Character ) >= 0 \
			and block_ExistingLines == False:
				mediaLink_Line = True
				invalidLine = True
			elif regionText.find ( mediaLink_Character ) >= 0 \
			and block_ExistingLines == True:
				invalidLine = True

			if regionText.find ( mediaLink_WrapperFill ) >= 0 : invalidLine = True
			if regionText.find ( titleEndcap )           >= 0 : invalidLine = True
			if regionText.find ( titleFill )             >= 0 : invalidLine = True
			if regionText.find ( commentStart )          >= 0 : invalidLine = True
			if regionText.find ( commentEnd )            >= 0 : invalidLine = True

			if mediaLink_Line == True:
				mediaLink_Region = Commands.get_MediaLink_Region ( view, region )
				if mediaLink_Region != False: mediaLink_Regions.append ( mediaLink_Region )
				continue

			if regionLine_A != regionLine_B \
			or invalidLine == True \
			or ( ( regionText == "" ) and ( cursor_AtLineStart == False ) ):
				continue

			if cursor_AtLineStart == True \
			and regionText == "":
				mediaLink_Title = mediaLink_Title_Default
				regionLine_A = sublime.Region ( view.line ( region.a ).a, view.line ( region.a ).b  )
			else:
				mediaLink_Title = regionText
				regionLine_A = view.line ( region.a )

			mediaLink_Text     = mediaLink_Prefix + mediaLink_Title + mediaLink_Suffix
			mediaLink_Position = regionLine_A.a + len ( mediaLink_Prefix )
			mediaLink_Region   = sublime.Region ( mediaLink_Position, mediaLink_Position + len ( mediaLink_Title ) )

			view.replace ( edit, regionLine_A, mediaLink_Text )
			mediaLink_Regions.append ( mediaLink_Region )

		view.selection.clear ()
		view.selection.add_all ( mediaLink_Regions )
		view.run_command ( "reverse_selection_direction" )

		if wrapperEnabled == True \
		and regionText != "":
			Commands.insert_MediaLink_Wrapper ( edit, view )

		#▐▌»»▒▐▌────────────────────────────────────────▐▌▒««▐▌_________________________________________________________________________________________________________________________________________¦••⌠#
		#▐▌»»▒▐▌    • •   insert_MediaLink_Wrapper      ▐▌▒««▐▌░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░m2#
		#▐▌»»▒▐▌────────────────────────────────────────▐▌▒««▐▌‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾¦••⌡#

	def insert_MediaLink_Wrapper ( edit, view ):

		mediaLink_Regions = []

		userSettings             = sublime.load_settings ( "SublimeSlides.sublime-settings" )
		mediaLink_Character      = userSettings.get ( "medialink_character", "" )
		mediaLink_TabAmount      = userSettings.get ( "medialink_tab_amount", "" )
		mediaLink_WrapperEnabled = userSettings.get ( "medialink_wrapper_enabled", "" )
		mediaLink_WrapperFill    = userSettings.get ( "medialink_wrapper_fill", "" )
		commentStart, commentEnd = Commands.get_CommentCharacters ()

		selectedRegions = view.sel ()

		skipItem = False

		if mediaLink_WrapperEnabled != "True" \
		or len ( selectedRegions ) == 0:
			skipItem = True

		if skipItem == False:

			mediaLink_SurroundingText_Length = len ( mediaLink_Character + V.spaceCharacter + mediaLink_Character )

			if commentEnd != "":
				mediaLink_SurroundingText_Length = mediaLink_SurroundingText_Length + len ( V.spaceCharacter )

			for region in selectedRegions:

				region.a          = region.a
				regionLine_A      = view.line ( region )
				regionText        = view.substr ( region )
				regionText_Length = len ( regionText )

				if ( regionText == V.mediaLink_DefaultTitle ):
					continue

				mediaLink_WrapperLine_Text = \
					( V.tabCharacter * mediaLink_TabAmount )                                      + \
					commentStart                                                                         + \
					( mediaLink_WrapperFill * ( regionText_Length + mediaLink_SurroundingText_Length ) ) + \
					commentEnd

				view.insert ( edit, regionLine_A.a, mediaLink_WrapperLine_Text + "\n" )
				view.insert ( edit, regionLine_A.a, mediaLink_WrapperLine_Text + "\n" )

			view.run_command ( "swap_line_up" )

		#▐▌»»▒▐▌────────────────────────────────▐▌▒««▐▌_________________________________________________________________________________________________________________________________________________¦••⌠#
		#▐▌»»▒▐▌    • •   insert_MediaFile      ▐▌▒««▐▌░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░m2#
		#▐▌»»▒▐▌────────────────────────────────▐▌▒««▐▌‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾¦••⌡#

	def insert_MediaFile ( edit, view ):

		filePath_Regions = []

		userSettings             = sublime.load_settings ( "SublimeSlides.sublime-settings" )
		mediaPath_TabAmount      = userSettings.get ( "mediapath_tab_amount", "" )
		mediaLink_Character      = userSettings.get ( "medialink_character", "" )
		commentStart, commentEnd = Commands.get_CommentCharacters ()

		mediaLink_Prefix = commentStart + mediaLink_Character + V.spaceCharacter
		mediaLink_Suffix = V.spaceCharacter + mediaLink_Character

		if commentEnd != "":
			mediaLink_Suffix = mediaLink_Suffix + commentEnd

		filePath_Prefix = \
			"\n" + \
			( V.tabCharacter * mediaPath_TabAmount ) + \
			commentStart + \
			" @ "

		filePath_Suffix = V.spaceCharacter + commentEnd

		complete_FilePath = filePath_Prefix + V.filePath_DefaultTitle + filePath_Suffix

		Commands.insert_MediaLink ( edit, view, False, True )

		selectedRegions = view.sel ()
		view.run_command ( "reverse_selection_direction" )

		mediaLink_LeftOffset  = len ( commentStart ) + len ( " @ " )
		mediaLink_RightOffset = 0

		if commentEnd != "":
			mediaLink_RightOffset = len ( V.spaceCharacter ) + len ( mediaLink_Character ) + len ( commentEnd )

		for region in selectedRegions:

			regionLine_A = view.line ( region.a )
			regionText = view.substr ( regionLine_A ).strip ()
			trimmed_RegionText = regionText [ len ( mediaLink_Prefix ) : len ( regionText ) - len ( mediaLink_Suffix ) ]

			newLine_Position = region.b + mediaLink_RightOffset
			view.insert ( edit, newLine_Position, complete_FilePath )

			filePathRegion_A = region.a + len ( filePath_Prefix ) + mediaLink_LeftOffset + mediaLink_RightOffset
			filePathRegion_B = region.b + len ( filePath_Prefix + V.filePath_DefaultTitle ) + mediaLink_RightOffset
			filePathRegion   = sublime.Region ( filePathRegion_A, filePathRegion_B )

			if trimmed_RegionText != V.mediaLink_DefaultTitle:
				filePath_Regions.append ( filePathRegion )
			else:
				filePath_Regions.append ( region )

		view.selection.clear ()
		view.selection.add_all ( filePath_Regions )
		view.run_command ( "reverse_selection_direction" )

	#▓▓▓▓▓──────────────────────────────▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓¦•⌠#
	#░░░░░                              ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░‡#
	#░░░░░      •   { MediaLinks }      ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░g3#
	#░░░░░                              ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░‡#
	#▓▓▓▓▓──────────────────────────────▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓¦•⌡#

		#▐▌»»▒▐▌──────────────────────────────▐▌▒««▐▌___________________________________________________________________________________________________________________________________________________¦••⌠#
		#▐▌»»▒▐▌    • •   open_MediaLink      ▐▌▒««▐▌░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░m2#
		#▐▌»»▒▐▌──────────────────────────────▐▌▒««▐▌‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾¦••⌡#

	def open_MediaLink ( view ):

		application   = ""
		fileExtension = ""

			#═════      • • •   Load Settings      ═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════⌠¦•••s1⌡#

		userSettings        = sublime.load_settings ( "SublimeSlides.sublime-settings" )
		mediaLink_Character = userSettings.get ( "medialink_character", "" )
		mediaFileTypes      = userSettings.get ( "mediafile_types", [] )

			#═════      • • •   Set Comment Characters      ══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════⌠¦•••s1⌡#

		commentStart, commentEnd = Commands.get_CommentCharacters ()

		fileStart_Offset = len ( commentStart ) + len ( "@" )
		fileEnd_Offset   = len ( commentEnd )

			#═════      • • •   Check For Selections      ════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════⌠¦•••s1⌡#

		selectedRegions = view.sel ()

		if len ( selectedRegions ) == 0:
			return

			#═════      • • •   Get Selected Text      ═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════⌠¦•••s1⌡#

		cursorSelection         = selectedRegions [0]
		cursorSelection_A       = cursorSelection.a
		cursorSelection_B       = cursorSelection.b
		cursorLine_A            = view.line ( cursorSelection_A )
		cursorLine_Text         = view.substr ( cursorLine_A )
		cursorRow, cursorColumn = view.rowcol ( cursorSelection_A )

			#═════      • • •   Get MediaLink      ═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════⌠¦•••s1⌡#

		mediaLink_Start = cursorLine_Text.find ( commentStart + mediaLink_Character + V.spaceCharacter )
		mediaLink_End   = cursorLine_Text.rfind ( V.spaceCharacter + mediaLink_Character + commentEnd )

		mediaLink_Prefix = commentStart + mediaLink_Character + V.spaceCharacter
		mediaLink_Suffix = V.spaceCharacter + mediaLink_Character

		if commentEnd != "":
			mediaLink_Suffix = mediaLink_Suffix + commentEnd

		mediaLink_LeftOffset  = len ( mediaLink_Prefix )
		mediaLink_RightOffset = len ( mediaLink_Suffix )

		cursorLine_MediaLink = cursorLine_Text [ mediaLink_Start : mediaLink_End + mediaLink_RightOffset ]
		cursorLine_Offset    = len ( cursorLine_Text ) - len ( cursorLine_MediaLink )

			# ? ? ?     • • •   Verify MediaLink Selection      ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ⌠¦•••i1⌡#

		if cursorColumn <= mediaLink_Start + mediaLink_LeftOffset \
		or cursorColumn >= mediaLink_End:
			return

		if not re.match ( V.mediaLink_RegEx, cursorLine_MediaLink ) \
		or mediaLink_Start == -1 \
		or cursorSelection_A != cursorSelection_B:
			return

			#═════      • • •   Find MediaLink FilePath      ═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════⌠¦•••s1⌡#

		mediaFile_Path    = ""

		mediaFile_Regions = Commands.find_MediaPaths ( view )

		for region in mediaFile_Regions:

			region.a               = region.a
			regionLine_A           = view.line ( region.a )
			mediaLink_Text         = view.substr ( regionLine_A )
			trimmed_MediaLink_Text = mediaLink_Text.lstrip ()

			mediaLink_PathLine     = view.line ( region.b )
			mediaLink_Path         = view.substr ( mediaLink_PathLine )
			trimmed_MediaLink_Path = mediaLink_Path.lstrip ()

			if trimmed_MediaLink_Text == cursorLine_MediaLink:
				mediaFile_Path = trimmed_MediaLink_Path
				break

		if mediaFile_Path == "":
			print ( V.errorStart + "\"" + cursorLine_MediaLink + "\"" + " MediaLink not found" + V.errorEnd )
			return

		trimmed_MediaFile_Path = mediaFile_Path [ fileStart_Offset : len ( mediaFile_Path ) ].lstrip ()

		whitespaceOffset = \
			( len ( mediaFile_Path ) - len ( trimmed_MediaFile_Path ) )   \
			+ ( len ( mediaLink_Path ) - len ( trimmed_MediaLink_Path ) ) \
			- fileStart_Offset

			#═════      • • •   Set MediaLink FilePath      ══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════⌠¦•••s1⌡#

		filePath_Region = sublime.Region ( mediaLink_PathLine.a + fileStart_Offset + whitespaceOffset, mediaLink_PathLine.b - fileEnd_Offset )
		nextLine_Region = sublime.Region ( mediaLink_PathLine.b + 1, mediaLink_PathLine.b + 1 )
		filePath        = view.substr ( filePath_Region )
		filePath_Length = len ( filePath )

		filePath = filePath.rstrip ()
		filePath = filePath.replace ( "\"", "" )
		filePath = filePath.replace ( "'", "" )

		filePath_StrippedLength = filePath_Length - len ( filePath )
		filePath_Length         = filePath_Length - filePath_StrippedLength
		filePath_Region         = sublime.Region ( filePath_Region.a, filePath_Region.b - filePath_StrippedLength )

		fileExtension_Index = filePath.rfind ( "." )

		if fileExtension_Index == -1:
			print ( V.errorStart + "\"" + filePath + "\"" + " has no file extension" + V.errorEnd )
			return

		fileExtension = filePath [ fileExtension_Index : filePath_Length ]

			# ? ? ?     • • •   Verify File      ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?⌠¦•••i1⌡#

		fileExists = os.path.exists ( filePath )

		if not fileExists:
			print ( V.errorStart + "\"" + filePath + "\"" + " does not exist" + V.errorEnd )
			return

			#═════      • • •   Set Application      ═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════⌠¦•••s1⌡#

		for fileType in mediaFileTypes:

			typeExtensions = mediaFileTypes [ fileType ] [ "extensions" ]

			for typeExtension in typeExtensions:

				if fileExtension == "." + typeExtension:
					application = mediaFileTypes [ fileType ] [ "application" ]

			# ? ? ?     • • •   Verify Application      ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ⌠¦•••i1⌡#

		applicationExists = os.path.exists ( application )

		if application == "" \
		or not applicationExists:
			print ( V.errorStart + "\"" + application + "\"" + " does not exist" + V.errorEnd )
			return

			# ? ? ?     • • •   Load Media File      ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?⌠¦•••i1⌡#

		selectionRegion_A = cursorLine_A.a + mediaLink_Start + mediaLink_LeftOffset
		selectionRegion_B = selectionRegion_A + ( len ( mediaLink_Text ) - ( mediaLink_LeftOffset + mediaLink_RightOffset ) ) - 1;

		selectionRegion = sublime.Region ( selectionRegion_A, selectionRegion_B )
		view.selection.clear ()
		view.selection.add ( selectionRegion )

		cmd = [ application, filePath ]
		subprocess.Popen ( cmd, stdin=subprocess.PIPE, stdout=subprocess.PIPE, stderr=subprocess.PIPE, startupinfo=subprocess.STARTUPINFO (), shell=False, creationflags=subprocess.SW_HIDE )

		#▐▌»»▒▐▌────────────────────────────────▐▌▒««▐▌_________________________________________________________________________________________________________________________________________________¦••⌠#
		#▐▌»»▒▐▌    • •   toggle_MediaLink      ▐▌▒««▐▌░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░m2#
		#▐▌»»▒▐▌────────────────────────────────▐▌▒««▐▌‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾¦••⌡#

	def toggle_MediaLink ():

		if EventListener.mediaLink_Enabled == True:

			EventListener.mediaLink_Enabled = False
			sublime.status_message ( "SublimeSlides MediaLink:  DISABLED" )

		elif EventListener.mediaLink_Enabled == False:

			EventListener.mediaLink_Enabled = True
			sublime.status_message ( "SublimeSlides MediaLink:  ENABLED" )

		#▐▌»»▒▐▌────────────────────────────────────▐▌▒««▐▌_____________________________________________________________________________________________________________________________________________¦••⌠#
		#▐▌»»▒▐▌    • •   get_MediaLink_Region      ▐▌▒««▐▌░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░m2#
		#▐▌»»▒▐▌────────────────────────────────────▐▌▒««▐▌‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾¦••⌡#

	def get_MediaLink_Region ( view, region ):

		userSettings             = sublime.load_settings ( "SublimeSlides.sublime-settings" )
		mediaLink_Character      = userSettings.get ( "medialink_character", "" )
		mediaLink_TabAmount      = userSettings.get ( "medialink_tab_amount", "" )
		mediaLink_WrapperFill    = userSettings.get ( "medialink_wrapper_fill", "" )
		titleEndcap              = userSettings.get ( "title_endcap", "" )
		titleFill                = userSettings.get ( "title_fill", "" )
		commentStart, commentEnd = Commands.get_CommentCharacters ()

		region.a     = region.a
		region.b     = region.b
		regionLine_A = view.line ( region.a )
		regionText   = view.substr ( regionLine_A )

		regionText_TrimmedLeft  = regionText.lstrip ()
		regionText_TrimmedRight = regionText.rstrip ()
		trimmedLeft_Length      = len ( regionText ) - len ( regionText_TrimmedLeft )
		trimmedRight_Length     = len ( regionText ) - len ( regionText_TrimmedRight )

		mediaLink_LeftOffset = trimmedLeft_Length + len ( commentStart ) + len ( mediaLink_Character ) + len ( V.spaceCharacter )
		mediaLink_RightOffset = trimmedRight_Length

		if commentEnd != "":
			mediaLink_RightOffset = trimmedRight_Length + len ( V.spaceCharacter ) + len ( commentEnd )

		mediaLink_Region = sublime.Region ( regionLine_A.a + mediaLink_LeftOffset, regionLine_A.b - mediaLink_RightOffset )
		mediaLink_Text = view.substr ( mediaLink_Region )

		if mediaLink_Text != V.mediaLink_DefaultTitle:
			return ( mediaLink_Region )
		else:
			return False

	#▓▓▓▓▓──────────────────────────▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓¦•⌠#
	#░░░░░                          ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░‡#
	#░░░░░      •   { Slides }      ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░g3#
	#░░░░░                          ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░‡#
	#▓▓▓▓▓──────────────────────────▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓¦•⌡#

		#▐▌»»▒▐▌────────────────────────────▐▌▒««▐▌_____________________________________________________________________________________________________________________________________________________¦••⌠#
		#▐▌»»▒▐▌    • •   align_Titles      ▐▌▒««▐▌░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░m2#
		#▐▌»»▒▐▌────────────────────────────▐▌▒««▐▌‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾¦••⌡#

	def align_Titles ( edit, view ):

		view.run_command ( "unfold_all" )

		titleRegions = Commands.find_Titles ( view )

		for titleRegion in reversed ( titleRegions ):

			lineText  = view.substr ( titleRegion )
			titleText = Commands.add_TitleMarkers ( lineText, "Text" )

			view.replace ( edit, titleRegion, titleText )

		#▐▌»»▒▐▌────────────────────────────────▐▌▒««▐▌_________________________________________________________________________________________________________________________________________________¦••⌠#
		#▐▌»»▒▐▌    • •   add_TitleMarkers      ▐▌▒««▐▌░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░m2#
		#▐▌»»▒▐▌────────────────────────────────▐▌▒««▐▌‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾¦••⌡#

	def add_TitleMarkers ( titleText, titleMode ):

		userSettings          = sublime.load_settings ( "SublimeSlides.sublime-settings" )
		titleEndcap           = userSettings.get ( "title_endcap", "" )
		titleFill             = userSettings.get ( "title_fill", "" )
		title_StartCap_Length = userSettings.get ( "title_startcap_length", "" )
		titlePadding_Amount   = userSettings.get ( "title_padding", "" )
		title_MaxLength       = userSettings.get ( "title_max_length", "" )

		commentStart, commentEnd = Commands.get_CommentCharacters ()

		titleText = titleText.replace ( commentStart, "" )
		titleText = titleText.replace ( commentEnd, "" )
		titleText = titleText.replace ( titleEndcap, "" )
		titleText = titleText.replace ( titleFill, "" )
		titleText = titleText.strip ()

		titlePadding = V.spaceCharacter * titlePadding_Amount

		titlePrefix = \
			commentStart                          + \
			titleEndcap                           + \
			( titleFill * title_StartCap_Length ) + \
			titlePadding

		titlePosition = len ( titlePrefix )

		titleText = titlePrefix + titleText + titlePadding

		adjusted_MaxLength = title_MaxLength - ( len ( titleText ) + len ( titleEndcap ) + len ( commentEnd ) )

		titleText = \
			titleText                          + \
			( titleFill * adjusted_MaxLength ) + \
			titleEndcap                        + \
			commentEnd

		if titleMode == "Text":
			return ( titleText )

		if titleMode == "Offset":
			return ( titlePosition )

	#▓▓▓▓▓───────────────────────────▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓¦•⌠#
	#░░░░░                           ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░‡#
	#░░░░░      •   { Finders }      ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░g3#
	#░░░░░                           ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░‡#
	#▓▓▓▓▓───────────────────────────▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓¦•⌡#

		#▐▌»»▒▐▌────────────────────────────▐▌▒««▐▌_____________________________________________________________________________________________________________________________________________________¦••⌠#
		#▐▌»»▒▐▌    • •   find_Slides      ▐▌▒««▐▌░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░m2#
		#▐▌»»▒▐▌────────────────────────────▐▌▒««▐▌‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾¦••⌡#

	def find_Slides ( view, findMode ):

		contentRegion = sublime.Region ( 0, 0 )

		userSettings  = sublime.load_settings ( "SublimeSlides.sublime-settings" )
		titleEndcap   = userSettings.get ( "title_endcap", "" )

		commentStart, commentEnd = Commands.get_CommentCharacters ()

		cursorSelection = view.sel () [0]
		cursorLine_A    = view.line ( cursorSelection.a )

		if findMode == "Single":
			contentRegion = view.find ( V.content_RegEx, cursorLine_A.a )
		elif findMode == "All":
			contentRegion = view.find_all ( V.content_RegEx )

		return ( contentRegion )

		#▐▌»»▒▐▌───────────────────────────▐▌▒««▐▌______________________________________________________________________________________________________________________________________________________¦••⌠#
		#▐▌»»▒▐▌    • •   find_Titles      ▐▌▒««▐▌░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬m2#
		#▐▌»»▒▐▌───────────────────────────▐▌▒««▐▌‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾¦••⌡#

	def find_Titles ( view ):

		userSettings = sublime.load_settings ( "SublimeSlides.sublime-settings" )
		titleEndcap  = userSettings.get ( "title_endcap", "" )
		titleFill    = userSettings.get ( "title_fill", "" )

		commentStart, commentEnd = Commands.get_CommentCharacters ()

		titleRegions = view.find_all ( V.title_RegEx )
		return ( titleRegions )

		#▐▌»»▒▐▌───────────────────────────────▐▌▒««▐▌__________________________________________________________________________________________________________________________________________________¦••⌠#
		#▐▌»»▒▐▌    • •   find_MediaPaths      ▐▌▒««▐▌░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬m2#
		#▐▌»»▒▐▌───────────────────────────────▐▌▒««▐▌‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾¦••⌡#

	def find_MediaPaths ( view ):

		userSettings             = sublime.load_settings ( "SublimeSlides.sublime-settings" )
		mediaLink_Character      = userSettings.get ( "medialink_character", "" )
		commentStart, commentEnd = Commands.get_CommentCharacters ()

		mediaFile_Regions = view.find_all ( V.mediaPath_RegEx )

		return ( mediaFile_Regions )

		#▐▌»»▒▐▌───────────────────────────────▐▌▒««▐▌__________________________________________________________________________________________________________________________________________________¦••⌠#
		#▐▌»»▒▐▌    • •   find_MediaLinks      ▐▌▒««▐▌░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬m2#
		#▐▌»»▒▐▌───────────────────────────────▐▌▒««▐▌‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾¦••⌡#

	def find_MediaLinks ( view ):

		userSettings             = sublime.load_settings ( "SublimeSlides.sublime-settings" )
		mediaLink_Character      = userSettings.get ( "medialink_character", "" )
		commentStart, commentEnd = Commands.get_CommentCharacters ()

		mediaFile_Regions = view.find_all ( V.mediaLink_RegEx )

		return ( mediaFile_Regions )

	#▓▓▓▓▓─────────────────────────────▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓¦•⌠#
	#░░░░░                             ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░‡#
	#░░░░░      •   { Utilities }      ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░g3#
	#░░░░░                             ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░‡#
	#▓▓▓▓▓─────────────────────────────▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓¦•⌡#

		#▐▌»»▒▐▌────────────────────────────────────▐▌▒««▐▌_____________________________________________________________________________________________________________________________________________¦••⌠#
		#▐▌»»▒▐▌    • •   get_VisibleRegion      ▐▌▒««▐▌░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░m2#
		#▐▌»»▒▐▌────────────────────────────────────▐▌▒««▐▌‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾¦••⌡#

	def get_VisibleRegion ( view, zoom_OnFail ):

		visibleRegion = False

		documentStart  = 0
		documentEnd    = view.size ()
		documentRegion = sublime.Region ( documentStart, documentEnd )

		foldedRegions      = view.unfold ( documentRegion )
		foldedRegion_Count = len ( foldedRegions )
		view.fold ( foldedRegions )

		if foldedRegion_Count == 2:
			visibleRegion = sublime.Region ( foldedRegions [0].b + 1, foldedRegions [1].a )

		elif foldedRegion_Count == 1 \
		and foldedRegions [0].a == documentStart:
			visibleRegion = sublime.Region ( foldedRegions [0].b + 1, documentEnd )

		elif foldedRegion_Count == 1 \
		and foldedRegions [0].b == documentEnd:
			visibleRegion = sublime.Region ( documentStart, foldedRegions [0].a )

		if visibleRegion == False \
		and zoom_OnFail == True:
			Commands.zoom_Out ( view )
			Commands.zoom_In ( view, "Automatic" )
			return ( False )

		elif visibleRegion == False \
		and zoom_OnFail == False:
			return ( documentRegion )

		else:
			return ( visibleRegion )

		#▐▌»»▒▐▌─────────────────────────────────────▐▌▒««▐▌____________________________________________________________________________________________________________________________________________¦••⌠#
		#▐▌»»▒▐▌    • •   get_CommentCharacters      ▐▌▒««▐▌░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬░╬m2#
		#▐▌»»▒▐▌─────────────────────────────────────▐▌▒««▐▌‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾¦••⌡#

	def get_CommentCharacters ():

		commentStart = ""
		commentEnd   = ""

		userSettings      = sublime.load_settings ( "SublimeSlides.sublime-settings" )
		commentCharacters = userSettings.get ( "comment_characters", [] )

		documentExtension = sublime.active_window ().extract_variables () ["file_extension"]

		for documentType in commentCharacters:

			if commentCharacters [ documentType ] [ "extension" ] == documentExtension:

				commentStart = commentCharacters [ documentType ] [ "comment_start" ]
				commentEnd   = commentCharacters [ documentType ] [ "comment_end" ]

		return ( commentStart, commentEnd )

#▐▌▒▓▒▐▌═════════════════════════▐▌▒▓▒▐▌▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄¦⌠#
#▐▌▓▒▓▐▌                         ▐▌▓▒▓▐▌▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓‡#
#▐▌▒▓▒▐▌      EventListener      ▐▌▒▓▒▐▌██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████c3#
#▐▌▓▒▓▐▌                         ▐▌▓▒▓▐▌▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓‡#
#▐▌▒▓▒▐▌═════════════════════════▐▌▒▓▒▐▌▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀¦⌡#

class EventListener ( sublime_plugin.EventListener ):

	mediaLink_Enabled = True

	def on_selection_modified ( self, view ):

		userSettings      = sublime.load_settings ( "SublimeSlides.sublime-settings" )
		mediaLink_OnClick_Enabled = userSettings.get ( "medialink_onclick", "" )

		if EventListener.mediaLink_Enabled == True \
		and mediaLink_OnClick_Enabled == "True":
			Commands.open_MediaLink ( view )

#▐▌▒▓▒▐▌═════════════════════▐▌▒▓▒▐▌▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄¦⌠#
#▐▌▓▒▓▐▌                     ▐▌▓▒▓▐▌▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓‡#
#▐▌▒▓▒▐▌      Variables      ▐▌▒▓▒▐▌██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████c3#
#▐▌▓▒▓▐▌                     ▐▌▓▒▓▐▌▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓‡#
#▐▌▒▓▒▐▌═════════════════════▐▌▒▓▒▐▌▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀¦⌡#

class V ():

	userSettings             = sublime.load_settings ( "SublimeSlides.sublime-settings" )
	mediaLink_Character      = userSettings.get ( "medialink_character", "" )
	mediaLink_TabAmount      = userSettings.get ( "medialink_tab_amount", "" )
	mediaLink_WrapperFill    = userSettings.get ( "medialink_wrapper_fill", "" )
	titleEndcap              = userSettings.get ( "title_endcap", "" )
	titleFill                = userSettings.get ( "title_fill", "" )
	commentStart, commentEnd = Commands.get_CommentCharacters ()

	errorStart = "▌▓▓▓▓▓   @SublimeSlides: "
	errorEnd   = "   ▓▓▓▓▓▐"

	tabCharacter   = "	"
	spaceCharacter = " "

	slide_DefaultTitle     = "___SLIDE_TITLE_GOES_HERE___"
	mediaLink_DefaultTitle = "___MEDIALINK_TITLE_GOES_HERE___"
	filePath_DefaultTitle  = "___FILEPATH_GOES_HERE___"

	content_RegEx = \
		"(" + commentStart + titleEndcap + ")"     + \
		"("                                        + \
			"("                                       + \
				"([\\S\\s]*?)"                           + \
				"(?=" + commentStart + titleEndcap + ")" + \
			")"                                       + \
			"|"                                       + \
			"([\\S\\s]*)"                             + \
		")"

	title_RegEx = \
		"(" + commentStart + titleEndcap + ")"    + \
		"(" + titleFill + "*)"              + \
		"(.*" + titleEndcap + commentEnd + "\S*)" + \
		"(.*)"

	mediaPath_RegEx = \
		"([\\	\\ ]*" + commentStart + mediaLink_Character + ".*" + mediaLink_Character + ".*)" + \
		"(\n[\\	\\ ]*" + commentStart + "@.*)"

	mediaLink_RegEx = commentStart + mediaLink_Character + ".*" + mediaLink_Character + commentEnd
